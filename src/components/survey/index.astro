---
import { validateSurveyFile } from "@/lib/validators/survey-schema";
import profileQuestionsRaw from "@/survey/1-profile.yml";
import learningQuestionsRaw from "@/survey/2-learning-and-education.yml";
import workQuestionRaw from "@/survey/3-work.yml";
import aiQuestionRaw from "@/survey/4-ai.yml";
import techQuestionRaw from "@/survey/5-tech.yml";
import communityQuestionRaw from "@/survey/6-community.yml";
import ExitPopup from "./exit-popup.astro";
import { SurveyApp } from "./survey-app";

// Validate each YAML file to ensure data integrity
const profileQuestions = validateSurveyFile(
  profileQuestionsRaw,
  "1-profile.yml"
);
const learningQuestions = validateSurveyFile(
  learningQuestionsRaw,
  "2-learning-and-education.yml"
);
const workQuestion = validateSurveyFile(workQuestionRaw, "3-work.yml");
const aiQuestion = validateSurveyFile(aiQuestionRaw, "4-ai.yml");
const techQuestion = validateSurveyFile(techQuestionRaw, "5-tech.yml");
const communityQuestion = validateSurveyFile(
  communityQuestionRaw,
  "6-community.yml"
);

const questions = [
  profileQuestions,
  learningQuestions,
  workQuestion,
  aiQuestion,
  techQuestion,
  communityQuestion
];
---

<div id="survey-form" class="min-h-screen min-w-full">
  <SurveyApp questions={questions} client:only="react" />
</div>

<ExitPopup />
